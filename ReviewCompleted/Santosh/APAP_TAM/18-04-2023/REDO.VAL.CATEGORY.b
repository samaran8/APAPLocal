$PACKAGE APAP.TAM
SUBROUTINE REDO.VAL.CATEGORY
*-------------------------------------------------------------------------
* Company Name  : ASOCIACION POPULAR DE AHORROS Y PRESTAMOS
* Developed By  : PRJESH
* Program Name  : REDO.VAL.CATEGORY
* ODR Number    : ODR-2011-02-0099
*-------------------------------------------------------------------------

* Description :This validation routine used to update the field grace date
* in AZ.ACCOUNT

* Linked with:COLLATERAL
* In parameter : None
* out parameter : None

** 18-04-2023 R22 Auto Conversion no changes
** 18-04-2023 Skanda R22 Manual Conversion - No changes
***---------------------------------------------------------------


    $INSERT I_COMMON
    $INSERT I_EQUATE
    $INSERT I_GTS.COMMON
    $INSERT I_F.COLLATERAL

    GOSUB INIT
    GOSUB PROCESS

RETURN
*--------------
INIT:
*---------------
    FN.COLLATERAL ='F.COLLATERAL'
    F.COLLATERAL =''
    CALL OPF(FN.COLLATERAL,F.COLLATERAL)

    LOC.REF.APPLICATION="COLLATERAL"
    LOC.REF.FIELDS='L.COL.SEC.IDEN':@VM:'L.COL.DESG.NO':@VM:'L.COL.SOLAR.NO':@VM:'L.COL.BLOCK.NO':@VM:'L.COL.CAD.DIST':@VM:'L.COL.PROVINCES':@VM:'L.COL.CITY':@VM:'L.COL.SECTOR':@VM:'L.COL.PRO.DESC2':@VM:'L.COL.ISS.ENTY':@VM:'L.COL.INVST.TYE':@VM:'L.COL.ENTY.INS':@VM:'L.COL.NAT.TAX':@VM:'L.COL.INVST.NO':@VM:'L.COL.INVST.DT':@VM:'L.COL.ENTY.INS':@VM:'L.COL.VALU.NAM':@VM:'L.COL.VAL.DATE':@VM:'L.COL.LAND.AREA':@VM:'L.COL.LAND.VAL':@VM:'L.COL.TO.LND.VA':@VM:'L.COL.BLD.AREA':@VM:'L.COL.BLD.VALUE':@VM:'L.COL.TOT.BD.AR':@VM:'L.COL.YR.BLDING':@VM:'L.COL.TOTAL.DEP':@VM:'L.COL.DEP.VALUE':@VM:'L.COL.TOT.VALUA':@VM:'L.COL.LN.MX.PER':@VM:'L.COL.LN.MX.VAL':@VM:'L.P.AVA.CONT':@VM:'L.COL.REVIEW.DT':@VM:'L.COL.VA.DUE.DT':@VM:'L.AC.LK.COL.ID'
    LOC.REF.POS=''
    CALL MULTI.GET.LOC.REF(LOC.REF.APPLICATION,LOC.REF.FIELDS,LOC.REF.POS)
    Y.COL.SEC         =LOC.REF.POS<1,1>
    Y.COL.DESG        =LOC.REF.POS<1,2>
    Y.COL.SOLAR       =LOC.REF.POS<1,3>
    Y.COL.BLOCK       =LOC.REF.POS<1,4>
    Y.COL.CAD.DIST    =LOC.REF.POS<1,5>
    Y.COL.PROVINCES   =LOC.REF.POS<1,6>
    Y.COL.CITY        =LOC.REF.POS<1,7>
    Y.COL.SECTOR      =LOC.REF.POS<1,8>
    Y.COL.PRO.DESC2   =LOC.REF.POS<1,9>
    Y.COL.ISS         =LOC.REF.POS<1,10>
    Y.COL.INVST       =LOC.REF.POS<1,11>
    Y.COL.ENTY        =LOC.REF.POS<1,12>
    Y.COL.NAT         =LOC.REF.POS<1,13>
    Y.COL.INVST.NO    =LOC.REF.POS<1,14>
    Y.COL.INVST.DT    =LOC.REF.POS<1,15>
    Y.COL.ENTY.INS    =LOC.REF.POS<1,16>
    Y.COL4.NAME       =LOC.REF.POS<1,17>
    Y.COL.VAL.DATE    =LOC.REF.POS<1,18>
    Y.COL.LAND.AREA   =LOC.REF.POS<1,19>
    Y.COL.LAND.VAL    =LOC.REF.POS<1,20>
    Y.COL.TO.LAND.VAL =LOC.REF.POS<1,21>
    Y.COL.BLD.AREA    =LOC.REF.POS<1,22>
    Y.COL.BLD.VAL     =LOC.REF.POS<1,23>
    Y.COL.TOT.BD.AR   =LOC.REF.POS<1,24>
    Y.COL.YR.BUILD    =LOC.REF.POS<1,25>
    Y.COL.TOT.DEP     =LOC.REF.POS<1,26>
    Y.COL.DEP.VALUE   =LOC.REF.POS<1,27>
    Y.COL.TOT.VALUA   =LOC.REF.POS<1,28>
    Y.COL.MX.PER      =LOC.REF.POS<1,29>
    Y.COL.MX.VAL      =LOC.REF.POS<1,30>
    Y.COL.AVA.CONT    =LOC.REF.POS<1,31>
    Y.COL.REVIEW.DT   =LOC.REF.POS<1,32>
    Y.COL4.VA.DUE.DT  =LOC.REF.POS<1,33>
    Y.COL.ADDED.VAL   =LOC.REF.POS<1,34>

RETURN
*--------------
PROCESS:
*---------------

    Y.ID = R.NEW(COLL.COLLATERAL.CODE)

    IF Y.ID EQ '500' OR Y.ID EQ '550' OR Y.ID EQ '600' OR Y.ID EQ '650' OR Y.ID EQ '700' THEN
        GOSUB CHECK
        IF R.NEW(COLL.COUNTRY) EQ '' THEN
            AF = COLL.COUNTRY
            ETEXT = "AC-INP.MAND"
            CALL STORE.END.ERROR
        END
    END
    IF Y.ID EQ '750' OR Y.ID EQ '800' THEN
        GOSUB CHECK
    END
    IF Y.ID EQ '250' OR Y.ID EQ '300' THEN
        GOSUB CHECK3
    END

    IF Y.ID EQ '850' OR Y.ID EQ '900' OR Y.ID EQ '950' THEN
        GOSUB CHECK4
    END
RETURN

*---------
CHECK:
*---------
    AF = COLL.LOCAL.REF
    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.SEC> EQ '' THEN
        AV = Y.COL.SEC
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END

    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.DESG> EQ '' THEN
        AV=Y.COL.DESG
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END

    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.SOLAR> EQ '' THEN
        AV=Y.COL.SOLAR
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END

    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.BLOCK> EQ '' THEN
        AV=Y.COL.BLOCK
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END

    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.CAD.DIST> EQ '' THEN
        AV=Y.COL.CAD.DIST
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END

    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.SECTOR> EQ '' THEN
        AV=Y.COL.SECTOR
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END

    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.CITY> EQ '' THEN
        AV=Y.COL.CITY
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END

    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.PROVINCES> EQ '' THEN
        AV=Y.COL.PROVINCES
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END

    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.PRO.DESC2> EQ '' THEN
        AV=Y.COL.PRO.DESC2
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END

    IF R.NEW(COLL.ADDRESS) EQ '' THEN
        AF = COLL.ADDRESS
        AV = 1
        ETEXT = "AC-INP.MAND"
        CALL STORE.END.ERROR
    END

RETURN

CHECK3:
    AF = COLL.LOCAL.REF
    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.ISS> EQ '' THEN
        AV=Y.COL.ISS
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END
    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.INVST> EQ '' THEN
        AV=Y.COL.INVST
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END
    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.ENTY> EQ '' THEN
        AV=Y.COL.ENTY
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END
    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.NAT> EQ '' THEN
        AV=Y.COL.NAT
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END
    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.INVST.NO> EQ '' THEN
        AV=Y.COL.INVST.NO
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END
    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.INVST.DT> EQ '' THEN
        AV=Y.COL.INVST.DT
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END
RETURN

CHECK4:
    AF = COLL.LOCAL.REF
    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL4.NAME> EQ '' THEN
        AV=Y.COL4.NAME
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END
    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.VAL.DATE> EQ '' THEN
        AV=Y.COL.VAL.DATE
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END
    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.LAND.AREA> EQ '' THEN
        AV=Y.COL.LAND.AREA
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END
    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.LAND.VAL> EQ '' THEN
        AV=Y.COL.LAND.VAL
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END
    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.BLD.AREA> EQ '' THEN
        AV=Y.COL.BLD.AREA
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END
    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.BLD.VAL> EQ '' THEN
        AV=Y.COL.BLD.VAL
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END
    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.YR.BUILD> EQ '' THEN
        AV=Y.COL.YR.BUILD
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END
    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.TOT.DEP> EQ '' THEN
        AV=Y.COL.TOT.DEP
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END
    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.AVA.CONT> EQ '' THEN
        AV=Y.COL.AVA.CONT
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END
    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.REVIEW.DT> EQ '' THEN
        AV=Y.COL.REVIEW.DT
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END
    IF R.NEW(COLL.LOCAL.REF)<1,Y.COL.ADDED.VAL> EQ '' THEN
        AV=Y.COL.ADDED.VAL
        ETEXT="AC-INP.MAND"
        CALL STORE.END.ERROR
    END
RETURN

END
